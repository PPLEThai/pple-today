
/* !!! This is code generated by Prisma. Do not edit directly. !!!
/* eslint-disable */
"use strict"
const { makeTypedQueryFactory: $mkFactory } = require("../runtime/client")
exports.get_candidate_user = /*#__PURE__*/ $mkFactory("\nWITH\ncandidate_user AS (\nSELECT * FROM get_candidate_user_by_follower($1)\nUNION ALL\nSELECT * FROM get_candidate_user_by_interaction($1)\nUNION ALL\nSELECT * FROM get_candidate_user_by_topic($1)\n),\n\nexcluded_users AS (\nSELECT\nufu.\"followedId\" AS user_id\nFROM\n\"UserFollowsUser\" ufu\nWHERE\nufu.\"followerId\" = $1\nUNION ALL\nSELECT\nDISTINCT candidate_user.user_id\nFROM\ncandidate_user\nUNION ALL\nSELECT\n$1 AS user_id\n),\n\nother_users AS (\nSELECT\n*\nFROM\n\"User\" u\nLEFT JOIN excluded_users e ON e.user_id = u.\"id\"\nWHERE\ne.user_id IS NULL AND u.\"status\" = 'ACTIVE'\n),\n\nother_candidate_user AS (\nSELECT\nou.id AS user_id,\n0 AS score\nFROM\nother_users ou\nLEFT JOIN candidate_user cu ON ou.id = cu.user_id\nWHERE\ncu.user_id IS NULL\n),\n\naggregated_candidate_score AS (\nSELECT\nother_candidate_user.user_id,\nother_candidate_user.score\nFROM\nother_candidate_user\nINNER JOIN \"User\" u ON other_candidate_user.user_id = u.id\nWHERE\nu.\"status\" = 'ACTIVE'\nUNION ALL\nSELECT\ncandidate_user.user_id,\ncandidate_user.score\nFROM\ncandidate_user\nINNER JOIN \"User\" u ON candidate_user.user_id = u.id\nWHERE\nu.\"status\" = 'ACTIVE'\n),\n\nfinal_candidate_score AS (\nSELECT\naggregated_candidate_score.user_id,\n(SUM(aggregated_candidate_score.score) + RANDOM()) AS score\nFROM\naggregated_candidate_score\nGROUP BY\naggregated_candidate_score.user_id\nORDER BY score DESC\nLIMIT 10\n)\n\nSELECT\nfinal_candidate_score.\"user_id\"\nFROM\nfinal_candidate_score;")
