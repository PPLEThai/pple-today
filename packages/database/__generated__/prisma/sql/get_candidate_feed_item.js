
/* !!! This is code generated by Prisma. Do not edit directly. !!!
/* eslint-disable */
"use strict"
const { makeTypedQueryFactory: $mkFactory } = require("../runtime/client")
exports.get_candidate_feed_item = /*#__PURE__*/ $mkFactory("WITH\ncandidate_feed_item AS (\nSELECT *\nFROM\nget_candidate_feed_item_by_follower ($1)\nUNION ALL\nSELECT *\nFROM\nget_candidate_feed_item_by_interaction ($1)\nUNION ALL\nSELECT *\nFROM\nget_candidate_feed_item_by_topic ($1)\n),\naggregated_feed_items AS (\nSELECT candidate_feed_item.feed_item_id, SUM(candidate_feed_item.score) + RANDOM () AS score\nFROM candidate_feed_item\nGROUP BY\ncandidate_feed_item.feed_item_id\n),\nother_feed_items AS (\nSELECT fi.id AS feed_item_id, RANDOM () * EXP(-LEAST(extract(EPOCH FROM (NOW() - fi.\"createdAt\")) / 86400, 30)) AS score\nFROM\n\"FeedItem\" fi\nLEFT JOIN aggregated_feed_items afi ON afi.feed_item_id = fi.id\nWHERE\nafi.feed_item_id IS NULL\n),\nfinal_candidate_score AS (\nSELECT other_feed_items.feed_item_id, other_feed_items.score\nFROM other_feed_items\nUNION ALL\nSELECT candidate_feed_item.feed_item_id, candidate_feed_item.score\nFROM candidate_feed_item\nORDER BY score DESC\nLIMIT 1000\n)\n\nSELECT final_candidate_score.\"feed_item_id\" FROM final_candidate_score;")
